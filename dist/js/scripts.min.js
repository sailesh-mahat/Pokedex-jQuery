var pokemonRepository=(function(){var repository=[];var apiUrl='https://pokeapi.co/api/v2/pokemon/?limit=150';var $modalContainer=$('#modal-container');function addListItem(pokemon){var $p=$('<p>'+pokemon.name+'</p>');var $infoButton=$('<button type="button" class="btn btn-secondary">view details</button>');var $li=$('<li class="list-group-item"></li>');$li.append($p);$li.append($infoButton);$('.list-group').append($li);$infoButton.on('click',function(event){showDetails(pokemon)})}
function showDetails(item){pokemonRepository.loadDetails(item).then(function(){pokemonRepository.showModal(item)})}
function add(pokemon){repository.push(pokemon)}
function getAll(){return repository}
function loadList(){return $.ajax(apiUrl).then(function(response){response.results.forEach(function(item){var pokemon={name:item.name,detailsUrl:item.url,};add(pokemon)})}).catch(function(e){console.error(e)})}
function loadDetails(item){return $.ajax(item.detailsUrl).then(function(response){item.imageUrl=response.sprites.front_default;item.height=response.height;item.types=response.types.map(function(item){return' '+item.type.name});item.ability=response.abilities.map(function(item){return' '+item.ability.name})}).catch(function(e){console.error(e)})}
function showModal(item){$('#modal-container').html('');var modal=$('<div class="modal-dialog"></div>');var closeButtonElement=$('<button type="button" class="btn btn-secondary">Close</button>');closeButtonElement.on('click',hideModal);var nameElement=$('<h1>'+item.name+'</h1>');var heightElement=$('<p>'+'height: '+item.height+'</p>');var imageElement=$('<img class="modal-image"></img>');imageElement.attr('src',item.imageUrl);var typesElement=$('<p>'+'Type: '+item.types+'</p>');var abilitiesElement=$('<p>'+'Abilities: '+item.ability+'</p>');var modalContent=$('<div class = "modal-content">');modalContent.append(closeButtonElement).append(nameElement).append(imageElement).append(heightElement).append(typesElement).append(abilitiesElement);modal.append(modalContent);$modalContainer.append(modal).addClass('is-visible')}
function hideModal(){$('#modal-container').removeClass('is-visible')}
$(window).on('keydown',(e)=>{if(e.key==='Escape'&&$('#modal-container').hasClass('is-visible')){hideModal()}});$('#modal-container').on('click',function(event){if($(event.target).is($modalContainer)){hideModal()}});return{add:add,getAll:getAll,addListItem:addListItem,loadList:loadList,loadDetails:loadDetails,showModal:showModal,hideModal:hideModal,}})();pokemonRepository.loadList().then(function(){pokemonRepository.getAll().forEach(function(pokemon){pokemonRepository.addListItem(pokemon)})})
 
